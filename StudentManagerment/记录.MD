# Main方法

 

```c#
public class Program
    {
        public static void Main(string[] args)
        {
            CreateHostBuilder(args).Build().Run();
        }

        public static IHostBuilder CreateHostBuilder(string[] args) =>
            Host.CreateDefaultBuilder(args)
                .ConfigureWebHostDefaults(webBuilder =>
                {
                    webBuilder.UseStartup<Startup>();
                });
    }
```

- CreateHostBuilder：
- CreateDefaultBuilder()：
  - 进行web服务的一些默认配置
  - 设置web服务器
  - 加载主机和应用程序配置表信息
  - 配置日志记录
- UseStartup:
  - Configure:
  - ConfigureServices:

# 进程内外托管

- 进程内托管
  - iisexpress vs集成的轻量级托管平台
  - 只有一个服务器、性能更好
- 进程外托管
  - kestrel(只能进程外托管 )
  - 两台服务器

# 配置文件

   访问顺序级别有上倒下主键提高

- appsettings.json -生产环境
- appsettings.Development --开发环境
- 用户机密 --存储在本地
- 环境变量

# 中间件

- 终端中间件只能存在一个
- 基本上app.usexxxx的都是中间件
- 处理请求中间价（终端）、静态文件中间件、错误页中间件、默认文件中间件（终端）
- 终端中间件会使管道短路，返回相应。

# 开发环境变量

- development
  - 开发环境
- staging
  - 演示环境、模拟、临时环境、预发布环境
- production
  - 生产环境、线上环境

# mvc

- 是用于实现应用程序的用户界面层的架构设计模式
  - 模型（Model）：包含一组数据的类和管理该数据的逻辑信息
  - 视图（view）:包含显示逻辑，用于显示Controller提供给它的模型中的数据
  - 控制器（Controller）:处理Http请求，调用模型，选择一个视图来呈现该模型

- 流程
  - 浏览器向服务器发送http请求
  - 首先到达控制器-Controller：第一时间处理请求-调用模型
  - Model：获取数据源-返回给控制层
  - View:控制层呈现model里面的数据-通过管道返回到浏览器上
- 模型（Model）
  - 属性类（xxxModel）：封装相应数据类的属性
  - 仓储（IxxxRepsitory）： 对数据仓库进行操作，在仓库中储存数据，增删改查等等。
- 视图（view）
  - 只是把Modle数据呈现出来，呈现出来后通过管道返回给浏览器
  - 功能尽量单一，只把模型数据展现出来
  - 如果modle太复杂了，放在仓库或者control里面过于臃肿，衍生出来viewModel
  - .net还衍生出来了视图组件
- mvc的控制器（controller）
  - 处理请求，相应
  - ![image-20220707105831886](C:\Users\22143\AppData\Roaming\Typora\typora-user-images\image-20220707105831886.png)

