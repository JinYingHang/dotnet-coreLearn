# Main方法

 

```c#
public class Program
    {
        public static void Main(string[] args)
        {
            CreateHostBuilder(args).Build().Run();
        }

        public static IHostBuilder CreateHostBuilder(string[] args) =>
            Host.CreateDefaultBuilder(args)
                .ConfigureWebHostDefaults(webBuilder =>
                {
                    webBuilder.UseStartup<Startup>();
                });
    }
```

- CreateHostBuilder：
- CreateDefaultBuilder()：
  - 进行web服务的一些默认配置
  - 设置web服务器
  - 加载主机和应用程序配置表信息
  - 配置日志记录
- UseStartup:
  - Configure:
  - ConfigureServices:

# 进程内外托管

- 进程内托管
  - iisexpress vs集成的轻量级托管平台
  - 只有一个服务器、性能更好
- 进程外托管
  - kestrel(只能进程外托管 )
  - 两台服务器

# 配置文件

   访问顺序级别有上倒下主键提高

- appsettings.json -生产环境
- appsettings.Development --开发环境
- 用户机密 --存储在本地
- 环境变量

# 中间件

- 终端中间件只能存在一个
